appId: ${APP_ID}
---
# Helper flow: Login user
# This flow logs in a user with provided email and password
# Usage: Can be run as a subflow from other tests
# Parameters: ${MAESTRO_TEST_EMAIL}, ${MAESTRO_TEST_PASSWORD}

# Assumes we're on the login screen
- assertVisible:
    text: "Welcome Back"

# Enter email
- tapOn:
    id: "email-input"
- inputText: ${MAESTRO_TEST_EMAIL}

# Enter password
- tapOn:
    id: "password-input"
- runScript: ../scripts/wait.js
- runFlow:
    when:
      visible:
        id: "password-input-toggle"
    commands:
      - tapOn:
          id: "password-input-toggle"
      - runScript: ../scripts/wait.js
      - tapOn:
          id: "password-input"
- inputText: ${MAESTRO_TEST_PASSWORD}

# Hide keyboard and submit
- hideKeyboard
- tapOn:
    id: "sign-in-button"
- waitForAnimationToEnd

# Wait for app to load
- runScript: ../scripts/wait.js

# Should be on Collections screen after successful login
- assertVisible:
    id: "screen-collections"
